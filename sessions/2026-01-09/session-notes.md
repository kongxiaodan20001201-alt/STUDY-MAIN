# Java 架构师学习会话记录

**日期**: 2026-01-09
**主题**: 分布式系统架构 (CAP/BASE, Redis 架构, Zookeeper, 分布式锁)
**状态**: ✅ 完成

## 🎓 学习内容概览
1. **CAP 定理与 BASE 理论**：
   - 明确了分布式系统必须保证 P (分区容错性)，只能在 CP (强一致) 和 AP (高可用) 之间权衡。
   - 掌握了 BASE 理论（最终一致性）是互联网高并发系统的核心哲学。
2. **Redis 架构深度解析**：
   - **Sentinel (哨兵)**：解决高可用，但无法解决海量存储，存在异步复制导致丢数据的风险。
   - **Cluster (集群)**：解决分片存储 (16384 Slot)，去中心化，但 Redlock 在此模式下无效。
   - **Redlock 辨析**：揭露了"单哨兵集群 + Redlock"的伪架构，明确了 Redlock 需要独立节点的苛刻条件。
3. **Zookeeper (CP 架构)**：
   - **ZAB 协议**：牺牲可用性（选主期间停服）换取强一致性。
   - **分布式锁实现**：利用"临时顺序节点 + Watcher"实现优雅的链式通知，避免了死循环轮询。
   - **死锁防范**：理解了为何不能用"持久节点"做锁（客户端宕机无法释放）。
4. **分布式事务 (入门)**：
   - 接触了 2PC (两阶段提交) 的"教堂婚礼"模型。

## 💡 核心见解 (Key Insights)
- **架构权衡**：在秒杀场景下，Redis (AP) + 数据库兜底 (BASE) 是比 Redlock 更优的选择。
- **工具选型**：Redis Cluster 适合高并发写；Zookeeper 适合强一致性协调；不要混用也不要神话 Redlock。
- **底层原理**：临时节点的生命周期绑定 Session，是解决分布式死锁的关键设计。

## 📉 知识缺口与难点
- **待解决**：分布式事务 2PC 的性能瓶颈（阻塞问题）。
- **待解决**：TCC、Saga、Seata 等现代分布式事务解决方案的落地。

## ✅ 掌握的主题
- [x] C.14 分布式系统理论基础 (CAP, BASE) (信心: 高)
- [x] C.16 分布式锁 (Redis vs Zookeeper 原理对比) (信心: 高)
- [x] C.20 分布式缓存 (Sentinel vs Cluster 架构) (信心: 高)
- [x] A.5/B.7 代理模式与 AOP 原理 (解决事务失效) (信心: 高)